<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guidance Robot - Home</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <header class="header">Sentry Scout</header>
    <main class="main">
        <div>
            <h2>Select Destination:</h2>
            <div id="goalpost" style="width: 500px; height: 500px; background-color: #eee; position: relative;">
                <img src="/static/images/goalpost.png" alt="Goalpost" style="width: 100%; height: 100%;"/>
                <div id="destination-indicator" style="position: absolute; background-color: red; width: 10px; height: 10px; border-radius: 50%; display: none;"></div>
            </div>
            <p id="coordinates-display">No destination selected</p>
        </div>
        <button id="send-destination-btn" class="speak-btn">Send Destination</button>
    </main>
    <footer class="footer">Status: Updates Here</footer>

    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script>
        const socket = io.connect('http://localhost:5000');
        const destinationIndicator = document.getElementById("destination-indicator");
        const coordinatesDisplay = document.getElementById("coordinates-display");

        // Function to handle map clicks and fetch coordinates
        document.getElementById('goalpost').addEventListener('click', function(event) {
            const goalpostRect = event.target.getBoundingClientRect();
            const clickX = event.clientX - goalpostRect.left; // Relative X
            const clickY = event.clientY - goalpostRect.top;  // Relative Y

            // Show the destination indicator on the map
            destinationIndicator.style.left = `${clickX - 5}px`;  // Adjust to center the dot
            destinationIndicator.style.top = `${clickY - 5}px`;   // Adjust to center the dot
            destinationIndicator.style.display = "block";

            // Display the coordinates on the page
            coordinatesDisplay.textContent = `Destination: X=${clickX}, Y=${clickY}`;

            // Send the coordinates to the backend via WebSocket
            socket.emit('send_destination', { x: clickX, y: clickY });
        });

    // Listen for the backend acknowledgment
    socket.on('destination_received', (data) => {
        console.log(data.message);  // Logs the confirmation message
        alert(data.message);        // Shows an alert with the confirmation message
    });
    </script>
</body>
</html>
